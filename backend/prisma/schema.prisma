generator client {
    provider = "prisma-client-js"
    output   = "../generated/prisma"
}

datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
}

model Role {
    id    Int    @id
    name  String @unique
    users User[]
}

model User {
    id               Int       @id @default(autoincrement())
    username         String    @unique
    email            String    @unique
    password         String
    roleId           Int       @default(0)
    role             Role      @relation(fields: [roleId], references: [id])
    is_verified      Boolean   @default(false)
    created_at       DateTime  @default(now())
    last_login       DateTime?
    profile_json     Json?
    receivedMessages Chat[]    @relation("ReceivedMessages")
    sentMessages     Chat[]    @relation("SentMessages")
    ideas            Idea[]
}

model Chat {
    id         Int      @id @default(autoincrement())
    senderId   Int
    receiverId Int
    content    String   @db.Text
    createdAt  DateTime @default(now())
    updatedAt  DateTime @updatedAt
    receiver   User     @relation("ReceivedMessages", fields: [receiverId], references: [id])
    sender     User     @relation("SentMessages", fields: [senderId], references: [id])

    @@index([receiverId], map: "chats_receiverId_fkey")
    @@index([senderId], map: "chats_senderId_fkey")
    @@map("chats")
}

model Idea {
    id            String   @id @default(cuid())
    title         String
    pitch         String   @db.Text
    description   String   @db.Text
    demoLink      String?
    pitchDeckUrl  String?
    ppt_Url       String?
    userId        Int?
    user          User?    @relation(fields: [userId], references: [id])
    status        String   @default("under_review")
    score         Int?
    fundingAmount Int?
    note          String?  @db.Text
    tags          String?
    createdAt     DateTime @default(now())
    updatedAt     DateTime @updatedAt

    @@index([userId], map: "ideas_userId_fkey")
}
